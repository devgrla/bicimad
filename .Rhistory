library(rjson)
library(dplyr)
library(plyr)
kk <- readLines("data/Bicimad_Stations_201811.json", encoding='ISO-8859-1')
kk <- readLines("https://drive.google.com/drive/u/0/folders/1CmQ_TPAcFdv_YddhgylvkJOG_Ks5yM6f/Bicimad_Stations_201811.json", encoding='ISO-8859-1')
kk <- Open("https://drive.google.com/drive/u/0/folders/1CmQ_TPAcFdv_YddhgylvkJOG_Ks5yM6f/Bicimad_Stations_201811.json", encoding='ISO-8859-1')
kk <- Open("https://drive.google.com/drive/u/0/folders/1CmQ_TPAcFdv_YddhgylvkJOG_Ks5yM6f/Bicimad_Stations_201811.json", "json")
library(rjson)
library(dplyr)
library(plyr)
kk <- Open("https://drive.google.com/drive/u/0/folders/1CmQ_TPAcFdv_YddhgylvkJOG_Ks5yM6f/Bicimad_Stations_201811.json", "encoding='ISO-8859-1'")
kk <- Open("https://drive.google.com/drive/u/0/folders/1CmQ_TPAcFdv_YddhgylvkJOG_Ks5yM6f/Bicimad_Stations_201811.json", "json")
library(RJSONIO)
kk <- fromJSON("https://drive.google.com/drive/u/0/folders/1CmQ_TPAcFdv_YddhgylvkJOG_Ks5yM6f/Bicimad_Stations_201811.json", "encoding='ISO-8859-1'")
kk <- fromJSON("https://drive.google.com/drive/u/0/folders/1CmQ_TPAcFdv_YddhgylvkJOG_Ks5yM6f/Bicimad_Stations_201811.json")
kk <- fromJSON("https://drive.google.com/drive/u/0/folders/1CmQ_TPAcFdv_YddhgylvkJOG_Ks5yM6f/Bicimad_Stations_201811.json")
kk <- fromJSON("https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc/Bicimad_Stations_201811.json")
kk <- fromJSON("https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc/Bicimad_Stations_201811.json")
library(jsonlite)
kk <- fromJSON("https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc/Bicimad_Stations_201811.json")
options(timeout= 4000000)
kk <- fromJSON("https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc/Bicimad_Stations_201811.json")
kk <- fromJSON("https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc")
kk <- fromJSON("https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc.json")
kk <- fromJSON("https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc")
kk= paste(kk, collapse="")
kk <- fromJSON("https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc")
kk <- readLines("https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc")
kk <- readLines("https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc", encoding='ISO-8859-1')
kk <- readLines("https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc", encoding='ISO-8859-1')
kk= paste(kk, collapse="")
tmp <- fromJSON(kk)
kk <- readLines("https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc", encoding='ISO-8859-1')
kk <- readLines("https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc", encoding='ISO-8859-1')
kk= paste(kk, collapse="")
tmp <- fromJSON(kk)
kk <- readLines("https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc", encoding='ISO-8859-1')
kk <- readLines("https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc", encoding='ISO-8859-1')
kk <- readLines("https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc", encoding='ISO-8859-1', warm=FALSE)
kk <- readLines("https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc", encoding='ISO-8859-1', warn=FALSE)
kk= paste(kk, collapse="")
tmp <- fromJSON(kk)
data = rjson::fromJSON(file="https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc", encoding='ISO-8859-1')
data = rjson::fromJSON(file="https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc")
library(httr)
text<- content(GET(url),type="text")
url <- "https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc"
text<- content(GET(url),type="text")
text<- sub("_id","",text)
text<- sub("stations","",text)
json <- fromJSON(text)
kk <- readLines("https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc&format=json", encoding='ISO-8859-1', warn=FALSE)
kk= paste(kk, collapse="")
tmp <- fromJSON(kk)
kk <- fromJSON(file="https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc&format=json", encoding='ISO-8859-1', warn=FALSE)
kk <- fromJSON(file="https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc", encoding='ISO-8859-1', warn=FALSE)
kk <- fromJSON(file="https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc")
kk <- fromJSON("https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc")
kk <- fromJSON(file="https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc",flatten=TRUE)
json <- fromJSON(getURL('https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc&format=j'))
library("RJSONIO")
library("(RCurl")
library("RCurl")
install.packages("RJSONIO")
library("RJSONIO")
json <- fromJSON(getURL('https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc&format=j'))
json <- fromJSON(getURL('https://drive.google.com/open?id=1PPXtCaj3ZW67yZp7Ef_R1TelhRsqmPsc'))
ac_2018 <- read.delim("dat/AccidentesBicicletas_2018.csv", sep = ";", header = TRUE)
ac_2018 <- read.delim("dat/AccidentesBicicletas_2018.csv", sep = ";", header = TRUE)
ac_2018 <- read.delim("./dat/AccidentesBicicletas_2018.csv", sep = ";", header = TRUE)
ac_2018 <- read.delim("./dat/AccidentesBicicletas_2018.csv", sep = ";", header = TRUE)
setwd("C:/Users/dgste/bicimad/dat")
setwd("C:/Users/dgste/bicimad/dat")
ac_2018 <- read.delim("dat/AccidentesBicicletas_2018.csv", sep = ";", header = TRUE)
setwd("C:/Users/dgste/bicimad")
ac_2018 <- read.delim("dat/AccidentesBicicletas_2018.csv", sep = ";", header = TRUE)
setwd("C:/Users/dgste/bicimad/")
ac_2018 <- read.delim("dat/AccidentesBicicletas_2018.csv", sep = ";", header = TRUE)
ac <- ac_2018
summary(ac)
View(ac)
ac_3 <- y %>%
group_by(distrito, dia.semana) %>%
summarize(n.victimas = sum(n_victimas, na.rm = TRUE))
setwd("C:/Users/dgste/bicimad/")
ac_2018 <- read.delim("dat/AccidentesBicicletas_2018.csv", sep = ";", header = TRUE)
ac <- ac_2018
summary(ac)
typeof(ac)
library(reshape2)
library(ggplot2)
#eliminamos las columnas que creemos que no son necesarios (aportan poca informacion)
colnames(ac)
ac[c(8,9,11,13,15:16,19)] <- list(NULL)
#modificamos los nombres de los campos restantes
colnames(ac) <- c("fecha","hora","dia_semana","distrito","lugar_accidente","Numero_accidente","n_parte","cpfa_lluvia","cpfa_seco","cpsv.mojada","cpsv_grava_suelta","cpsv_hielo","n_victimas","tipo_accidente","tipo_vehiculo","tipo_persona","sexo","lesividad","edad")
#cosas a cambiar
#Fecha
#Rango.Horario
#tramo.edad
#Cambiamos las fechas al formato fechas
ac$fecha <- as.Date(ac$fecha, "%d/%m/%Y")
#agregamos la columna mes y ponemos el mes en cuestion.
ac$mes <- format(ac$fecha, "%b")
#agregamos la columna mes y ponemos el dia en cuestion.
ac$dia <- format(ac$fecha, "%d")
tail(ac)
#Rango.Horario
#quitamos los de
head(ac)
#quitamos los "A" y la hora despues
ac$hora <- gsub("DE ", "",ac$hora)
ac$hora <- gsub("A [0-9]+:[0-9]+$", "",ac$hora)
ac$hora <- gsub(" ", "",ac$hora)
head(ac)
#Cambiamos tramo.edad (solo el primero)
ac$edad <- gsub("DE ", "",ac$edad)
ac$edad <- gsub("A [0-9][0-9] AÃ‘OS", "",ac$edad)
ac$edad <- gsub("A [0-9][0-9] ANOS", "",ac$edad)
ac$edad <- gsub(" ", "",ac$edad)
data(ac)
colnames(ac)
y$nv_medias <- ac[ac$n_victimas]
y <- ac[ac$n_victimas<14]
y <- ac[ac$n_victimas< 14,]
yhead(y)
ac[y]
ggplot(data=y, aes(x=distrito, y=n_victimas, fill=sexo)) +
geom_bar(stat="identity", position="dodge")
ac_3 <- y %>%
group_by(distrito, dia.semana) %>%
summarize(n.victimas = sum(n_victimas, na.rm = TRUE))
ac_3 <- y %>%
group_by(distrito, dia.semana) %>%
summarize(n.victimas = sum(n_victimas, na.rm = TRUE))
View(y)
ac_3 <- y %>%
group_by(distrito, dia_semana) %>%
summarize(n.victimas = sum(n_victimas, na.rm = TRUE))
View(ac_3)
View(y)
y %>%
group_by('distrito', 'dia_semana') %>%
summarize(n.victimas = sum(n_victimas, na.rm = TRUE))
View(y)
View(y)
y %>%
group_by(distrito, dia_semana) %>%
summarize(n.victimas = sum(n_victimas, na.rm = TRUE))
y %>%
group_by(mes, sexo) %>%
summarize(n.victimas = sum(n_victimas, na.rm = TRUE))
y %>%
group_by(mes, dia_semana) %>%
summarize(n.victimas = sum(n_victimas, na.rm = TRUE))
y %>%
group_by(mes, tipo_accidente) %>%
summarize(n.victimas = count(n_victimas, na.rm = TRUE))
y %>%
group_by(mes, tipo_accidente) %>%
summarize(tipo_accidente = count(tipo_accidente, na.rm = TRUE))
y %>%
group_by(mes, tipo_accidente) %>%
summarize(tipo_accidente = sum(tipo_accidente, na.rm = TRUE))
distplot(y)
